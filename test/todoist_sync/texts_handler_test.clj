(ns todoist-sync.texts-handler-test
  (:require [clojure.test :refer :all]
            [todoist-sync.texts-handler :refer :all]))

(deftest test-refs-parsed
  (testing "some refs parse"
    (is (= (list {:attributes {:href  "https://upsource.jetbrains.com/intellij/review/IDEA-CR-69547"
                          :style "color: rgb(15, 91, 153);"}
             :content    (list {:attributes nil
                                :content    (list "IDEA-CR-69547")
                                :tag        "strong"}
                               ": Review of dt/open-in-browser-intention branch")
             :tag        "a"})
           (parse-html-text "<a href=\"https://upsource.jetbrains.com/intellij/review/IDEA-CR-69547\" style=\"color: rgb(15, 91, 153);\"><strong>IDEA-CR-69547</strong>: Review of dt/open-in-browser-intention branch</a>")))
    (is (= (list "aaa")
           (parse-html-text "aaa")))
    ))

(deftest test-to-md
  (testing "pasing li"
    (is (= "\n  *  [IDEA-244537](https://youtrack.jetbrains.com/issue/IDEA-244537) Axios: template literal interpolations in urls are not supported\n\n  *  [IDEA-254105](https://youtrack.jetbrains.com/issue/IDEA-254105) Frameworks: http:// part of the path parsed differently in yaml with http path injection and in swagger specification\n\n  *  [IDEA-254646](https://youtrack.jetbrains.com/issue/IDEA-254646) Spring MVC: if the constant reference is used as mapping url value, completion/navigation/rename is not available for the path variable used in this url\n"
           (to-markdown (parse-html-text "<pre style=\"color: rgb(8, 8, 8); font-family: &quot;JetBrains Mono&quot;, monospace; font-size: 9.8pt;\"><ul style=\"white-space: normal; margin: 15px 0px 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; list-style-position: initial; list-style-image: initial; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" data-wfid=\"2d34d97c6d99\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-244537\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-244537</a>&nbsp;Axios: template literal interpolations in urls are not supported</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" data-wfid=\"3333ec44b1ca\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-254105\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-254105</a>&nbsp;Frameworks: http:// part of the path parsed differently in yaml with http path injection and in swagger specification</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" data-wfid=\"0d61397a90b6\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-254646\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-254646</a>&nbsp;Spring MVC: if the constant reference is used as mapping url value, completion/navigation/rename is not available for the path variable used in this url</span></li></ul></pre>"))))
    (is (= "[LAB-87](https://youtrack.jetbrains.com/issue/LAB-87) \n[Microservices Debugger ](https://youtrack.jetbrains.com/issue/LAB-87)[KT-41279](https://youtrack.jetbrains.com/issue/KT-41279) \n[calls to functions with reified parameters don't resolve ](https://youtrack.jetbrains.com/issue/KT-41279)\n"
           (to-markdown (parse-html-text "<a class=\"yt-issue-title yt-issues-issue__id\" yt-focus-if=\"false\" yt-issue-href=\"$ctrl.issue\" href=\"https://youtrack.jetbrains.com/issue/LAB-87\" style=\"outline-offset: -1px; font-size: 13px; display: inline-flex; margin-right: 6px; text-decoration: none; font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><yt-issue-id class=\"yt-dark-text yt-issue-id js-issue-id\" issue=\"$ctrl.issue\" data-test=\"issueId\" style=\"color: var(--ring-text-color); font-variant-ligatures: normal; font-variant-numeric: tabular-nums; font-variant-alternates: normal; font-variant-position: normal; font-variant-east-asian: normal;\">LAB-87</yt-issue-id></a><span style=\"caret-color: rgb(31, 35, 38); color: rgb(31, 35, 38); font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 13px; background-color: rgb(235, 246, 255);\">&nbsp;</span><a class=\"ring-link ring-link_pseudo yt-issue-title yt-issues-issue__summary\" yt-issue-href=\"::$ctrl.issue\" data-test=\"issueSummaryLink\" href=\"https://youtrack.jetbrains.com/issue/LAB-87\" style=\"cursor: pointer; transition: color var(--ring-fast-ease); text-decoration: none; color: var(--ring-link-color); outline-offset: -1px; font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><yt-issue-summary issue=\"$ctrl.issue\" class=\"yt-issue-summary\" data-test=\"issueSummary\">Microservices Debugger</yt-issue-summary>&nbsp;</a><div><a class=\"yt-issue-title yt-issues-issue__id\" yt-focus-if=\"false\" yt-issue-href=\"$ctrl.issue\" href=\"https://youtrack.jetbrains.com/issue/KT-41279\" style=\"outline-offset: -1px; font-size: 13px; display: inline-flex; margin-right: 6px; text-decoration: none; font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><yt-issue-id class=\"yt-dark-text yt-issue-id js-issue-id\" issue=\"$ctrl.issue\" data-test=\"issueId\" style=\"color: var(--ring-text-color); font-variant-ligatures: normal; font-variant-numeric: tabular-nums; font-variant-alternates: normal; font-variant-position: normal; font-variant-east-asian: normal;\">KT-41279</yt-issue-id></a><span style=\"caret-color: rgb(31, 35, 38); color: rgb(31, 35, 38); font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 13px; background-color: rgb(235, 246, 255);\">&nbsp;</span><a class=\"ring-link ring-link_pseudo yt-issue-title yt-issues-issue__summary\" yt-issue-href=\"::$ctrl.issue\" data-test=\"issueSummaryLink\" href=\"https://youtrack.jetbrains.com/issue/KT-41279\" style=\"cursor: pointer; transition: color var(--ring-fast-ease); text-decoration: none; color: var(--ring-link-color); outline-offset: -1px; font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><yt-issue-summary issue=\"$ctrl.issue\" class=\"yt-issue-summary\" data-test=\"issueSummary\">calls to functions with reified parameters don't resolve</yt-issue-summary>&nbsp;</a><br></div>"
                                         ))))
    )
  )

(deftest test-extract-issued
  (testing "extract"
    (is (= (list {:input-text "IDEA-214466 temporal language injection should support multi-line string literals with margins (Scala, Kotlin) @AlexeyKudravtsev"
                  :issue      "IDEA-214466"}
                 {:input-text "IDEA-220176 Provide API for registering language injection into concatenation expressions"
                  :issue      "IDEA-220176"}
                 {:input-text "IDEA-246131 Exception when injecting language into YAML quoted string literal using JSON schema @AlexeyMerkulov"
                  :issue      "IDEA-246131"}
                 {:input-text "KTIJ-679 Language injection could handle trimMargin case"
                  :issue      "KTIJ-679"}
                 {:input-text "IDEA-103887 Hibernate QL error checking fails to detect variable reassignments (String.format())"
                  :issue      "IDEA-103887"}
                 {:input-text "IDEA-135477 Good code is red: %s in String with injected language"
                  :issue      "IDEA-135477"}
                 {:input-text "IDEA-164871 Detecting SQL statements in code can be improved: String.format()"
                  :issue      "IDEA-164871"}
                 {:input-text "IDEA-161432 PostgreSQL. Good code red in concatenation"
                  :issue      "IDEA-161432"}
                 {:input-text "IDEA-62487 Concatenated JPA query highlighting error #mbfixed"
                  :issue      "IDEA-62487"}
                 {:input-text "IDEA-56184 HQL syntax highlight inside StringBuffer and StringBuilder"
                  :issue      "IDEA-56184"}
                 {:input-text "IDEA-55492 Broaden types allowed for @Language(\"SQL\")"
                  :issue      "IDEA-55492"}
                 {:input-text "IDEA-15818 Query not validated if obtained through StringBuffer/StringBuilder"
                  :issue      "IDEA-15818"}
                 {:input-text "IDEA-218604 Injected languages have error highlighting in the wrong place"
                  :issue      "IDEA-218604"}
                 {:input-text "EA-235335"
                  :issue      "EA-235335"}
                 {:input-text "EA-235334"
                  :issue      "EA-235334"}
                 {:input-text "EA-235333"
                  :issue      "EA-235333"}
                 {:input-text "EA-235336"
                  :issue      "EA-235336"}
                 {:input-text "EA-235440"
                  :issue      "EA-235440"})
           (extract-issues-from-html "<span class=\"name\" style=\"font-size: 16px; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap; line-height: 21px;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">Hard plan [choronlogical order]</span></span><ul style=\"margin: 15px 0px 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; list-style-position: initial; list-style-image: initial;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\">Выяснить статус и запланировать установку&nbsp;kotlin.uast.force.uinjectionhost=true</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><b style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">Intellij-lang. </b>Multiline Injection</span><ul style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; list-style: disc;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-214466\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-214466</a>&nbsp;temporal language injection should support multi-line string literals with margins (Scala, Kotlin) <span class=\"contentTag\" title=\"Filter @AlexeyKudravtsev\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">@<span class=\"contentTagText\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">AlexeyKudravtsev</span><span class=\"contentTagNub\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"></span></span></span></span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-220176\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-220176</a>&nbsp;Provide API for registering language injection into concatenation expressions</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-246131\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-246131</a>&nbsp;Exception when injecting language into YAML quoted string literal using JSON schema <span class=\"contentTag\" title=\"Filter @AlexeyMerkulov\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">@<span class=\"contentTagText\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">AlexeyMerkulov</span><span class=\"contentTagNub\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"></span></span></span></span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/KTIJ-679\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">KTIJ-679</a>&nbsp;Language injection could handle trimMargin case</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-103887\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-103887</a>&nbsp;Hibernate QL error checking fails to detect variable reassignments (String.format())</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-135477\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-135477</a>&nbsp;Good code is red: %s in String with injected language</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-164871\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-164871</a>&nbsp;Detecting SQL statements in code can be improved: String.format()</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-161432\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-161432</a>&nbsp;PostgreSQL. Good code red in concatenation</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-62487\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-62487</a>&nbsp;Concatenated JPA query highlighting error <span class=\"contentTag\" title=\"Filter #mbfixed\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">#<span class=\"contentTagText\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">mbfixed</span><span class=\"contentTagNub\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"></span></span> </span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-56184\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-56184</a>&nbsp;HQL syntax highlight inside StringBuffer and StringBuilder</span><ul style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; list-style: disc;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-55492\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-55492</a>&nbsp;Broaden types allowed for <span class=\"contentTag\" title=\"Filter @Language\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">@<span class=\"contentTagText\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">Language</span><span class=\"contentTagNub\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"></span></span>(\"SQL\")</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-15818\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-15818</a>&nbsp;Query not validated if obtained through StringBuffer/StringBuilder</span></li></ul></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-218604\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-218604</a>&nbsp;Injected languages have error highlighting in the wrong place</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\">YAML Exceptions</span><ul style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; list-style: disc;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://ea.jetbrains.com/browser/ea_problems/235335\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">EA-235335</a></span></span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"http://ea.jetbrains.com/browser/ea_problems/235334\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">EA-235334</a>&nbsp;</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"http://ea.jetbrains.com/browser/ea_problems/235333\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">EA-235333</a></span></span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"http://ea.jetbrains.com/browser/ea_problems/235336\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">EA-235336</a>&nbsp;</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"http://ea.jetbrains.com/browser/ea_problems/235440\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">EA-235440</a>&nbsp;</span></li></ul></li></ul></li><br class=\"Apple-interchange-newline\"></ul>"
                                     )))
    (is (= (list {:input-text "IDEA-236513 Implement `isReferenceTo` and `canResolveTo` for better part of PomTarget-references in Ultimate frameworks"
                  :issue      "IDEA-236513"}
                 {:input-text "IDEA-252443 [Upsource] Discussion in review IDEA-CR-62253"
                  :issue      "IDEA-CR-62253"}
                 {:input-text "IDEA-252443 [Upsource] Discussion in review IDEA-CR-62253"
                  :issue      "IDEA-252443"})
           (extract-issues-from-html "<span class=\"name\" style=\"font-size: 16px; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap; line-height: 21px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">Infra</span></span><ul style=\"margin: 15px 0px 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; list-style-position: initial; list-style-image: initial; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-236513\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-236513</a>&nbsp;Implement `isReferenceTo` and `canResolveTo` for better part of PomTarget-references in Ultimate frameworks</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-252443\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-252443</a>&nbsp;[Upsource] Discussion in review IDEA-CR-62253</span></li></ul>"
                                     )))
    (is (= (list {:input-text "IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy"
                  :issue      "IDEA-257015"})
           (extract-issues-from-html "IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy"
                                     )))
    (is (= (list {:input-text "KT-21297 Injected fragment editor doesn't know how to escape $ in raw strings IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy KTIJ-176 Edit json fragment for injected language removes escape for dollar sign"
                  :issue      "KT-21297"}
                 {:input-text "KT-21297 Injected fragment editor doesn't know how to escape $ in raw strings IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy KTIJ-176 Edit json fragment for injected language removes escape for dollar sign"
                  :issue      "IDEA-257015"}
                 {:input-text "KT-21297 Injected fragment editor doesn't know how to escape $ in raw strings IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy KTIJ-176 Edit json fragment for injected language removes escape for dollar sign"
                  :issue      "KTIJ-176"})
           (extract-issues-from-html "KT-21297 Injected fragment editor doesn't know how to escape $ in raw strings
 IDEA-257015 Edit RegExp fragment doesn't escape a literal dollar symbol in Kotlin #notmy
 KTIJ-176 Edit json fragment for injected language removes escape for dollar sign"
                                     )))
    (is (= (list {:input-text "IDEA-236513 Implement `isReferenceTo` and `canResolveTo` for better part of PomTarget-references in Ultimate frameworks"
                  :issue      "IDEA-236513"}
                 {:input-text "IDEA-252443 [Upsource] Discussion in review IDEA-CR-62253"
                  :issue      "IDEA-CR-62253"}
                 {:input-text "IDEA-252443 [Upsource] Discussion in review IDEA-CR-62253"
                  :issue      "IDEA-252443"})
           (extract-issues-from-html "<span class=\"name\" style=\"font-size: 16px; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap; line-height: 21px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><span class=\"innerContentContainer\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">Infra</span></span><ul style=\"margin: 15px 0px 0px; padding: 0px; border: 0px; outline: 0px; font-size: 13px; vertical-align: baseline; list-style-position: initial; list-style-image: initial; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Arial, sans-serif;\"><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-236513\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\">IDEA-236513</a>&nbsp;Implement `isReferenceTo` and `canResolveTo` for better part of PomTarget-references in Ultimate frameworks</span></li><li style=\"margin: 4px 0px 4px 20px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\"><span class=\"name\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; white-space: pre-wrap;\"><a class=\"contentLink\" target=\"_blank\" rel=\"noreferrer\" href=\"https://youtrack.jetbrains.com/issue/IDEA-252443\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; text-decoration: none; color: inherit; cursor: pointer;\"><span class=\"contentMatch\" style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline;\">IDEA-252443</span></a>&nbsp;[Upsource] Discussion in review IDEA-CR-62253</span></li></ul>"
                                     )))
    (is (= (list {:input-text "IDEA-220210 Thymeleaf code inspection slow in templates"
                  :issue      "IDEA-220210"}
                 {:input-text "KT-44134 Do not show \"Legacy Gradle Importing Model Detected\" notification for non-multiplatform projects"
                  :issue      "KT-44134"})
           (extract-issues-from-html "<a title=\"https://youtrack.jetbrains.com/issue/IDEA-220210\" href=\"https://youtrack.jetbrains.com/issue/IDEA-220210\" data-toggle=\"tooltip\" style=\"font-family: sans-serif; margin-right: 6px; font-size: 15px; color: rgb(20, 102, 198); text-decoration: none; display: inline;\">IDEA-220210</a><span style=\"font-family: sans-serif; font-size: medium; background-color: rgb(240, 240, 240);\">&nbsp;</span><a title=\"https://youtrack.jetbrains.com/issue/IDEA-220210\" href=\"https://youtrack.jetbrains.com/issue/IDEA-220210\" data-toggle=\"tooltip\" style=\"font-family: sans-serif; font-size: 15px; color: rgb(20, 102, 198); text-decoration: none; display: inline;\">Thymeleaf code inspection slow in templates</a><div><a title=\"https://youtrack.jetbrains.com/issue/KT-44134\" href=\"https://youtrack.jetbrains.com/issue/KT-44134\" data-toggle=\"tooltip\" style=\"font-family: sans-serif; margin-right: 6px; font-size: 15px; color: rgb(20, 102, 198); text-decoration: none; display: inline;\">KT-44134</a><span style=\"font-family: sans-serif; font-size: medium; background-color: rgb(240, 240, 240);\">&nbsp;</span><a title=\"https://youtrack.jetbrains.com/issue/KT-44134\" href=\"https://youtrack.jetbrains.com/issue/KT-44134\" data-toggle=\"tooltip\" style=\"font-family: sans-serif; font-size: 15px; color: rgb(20, 102, 198); text-decoration: none; display: inline;\">Do not show \"Legacy Gradle Importing Model Detected\" notification for non-multiplatform projects</a><br></div>"
                                     )))))
